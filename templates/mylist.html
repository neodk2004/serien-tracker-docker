<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meine Liste ‚Äì Serien Tracker</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Netflix+Sans:wght@300;400;700;900&display=swap" rel="stylesheet">
</head>
<body>
    <header class="netflix-header">
        <div class="header-container">
            <div class="logo">
                <span class="logo-icon">üé¨</span>
                <span class="logo-text">SERIEN TRACKER</span>
            </div>
            <nav class="nav-menu">
                <a href="/" class="nav-item">Startseite</a>
                <a href="/mylist" class="nav-item active">Meine Liste</a>
                {{if .IsAdmin}}
                <a href="/admin" class="nav-item">Admin</a>
                {{end}}
            </nav>
            <div class="header-actions">
                <div class="user-info">
                    Angemeldet als: <strong>{{index .Users .CurrentUser | .DisplayName}}</strong>
                </div>
                <a href="/" class="netflix-btn secondary small">Zur√ºck zur Suche</a>
            </div>
        </div>
    </header>

    <section class="hero-banner">
        <div class="hero-content">
            <h1 class="hero-title">Meine Serienliste</h1>
            <div class="hero-stats">
                <div class="stat">
                    <span class="stat-number">{{.TotalSeries}}</span>
                    <span class="stat-label">Serien</span>
                </div>
                <div class="stat">
                    <span class="stat-number">{{.TotalWatched}}</span>
                    <span class="stat-label">Episoden gesehen</span>
                </div>
            </div>
            <div class="sort-controls" style="margin-top: 20px;">
                <strong>Sortieren nach:</strong>
                <a href="/mylist?sort=title" class="netflix-btn secondary small">Titel ‚Üë</a>
                <a href="/mylist?sort=title_desc" class="netflix-btn secondary small">Titel ‚Üì</a>
                <a href="/mylist?sort=progress_desc" class="netflix-btn secondary small">Fortschritt ‚Üì</a>
                <a href="/mylist?sort=progress_asc" class="netflix-btn secondary small">Fortschritt ‚Üë</a>
            </div>
        </div>
        <div class="hero-gradient"></div>
    </section>

    {{if .ErrorMessage}}
    <div class="netflix-alert error">
        <div class="alert-content">
            <span class="alert-icon">‚ö†Ô∏è</span>
            <span class="alert-text">{{.ErrorMessage}}</span>
        </div>
    </div>
    {{end}}

    <section class="my-series-section">
        {{if .SeriesList}}
        <div class="series-grid">
            {{range .SeriesList}}
            <div class="series-card" data-progress="{{.Progress}}">
              {{if .CoverURL}}
                <img class="series-cover" src="{{.CoverURL}}" alt="{{.Title}}" onerror="this.style.display='none'">
              {{else}}
                <div class="poster-placeholder">üì∫</div>
              {{end}}

                <div class="card-header">
                    <div class="progress-ring">
                        <svg class="progress-circle" width="40" height="40">
                            <circle class="progress-bg" cx="20" cy="20" r="18"></circle>
                            <circle class="progress-fill" cx="20" cy="20" r="18"
                                    stroke-dasharray="113.097"
                                    stroke-dashoffset="0"></circle>
                        </svg>
                        <span class="progress-text">{{.Progress}}%</span>
                    </div>
                    <form action="/delete" method="post" class="delete-form">
                        <input type="hidden" name="id" value="{{.ID}}">
                        <button type="submit" class="delete-btn" title="Serie l√∂schen">
                            <span class="delete-icon">&times;</span>
                        </button>
                    </form>
                </div>

                <div class="card-content">
                    <h3 class="series-title">{{.Title}}</h3>
                    <p class="series-year">{{.Year}}</p>
                    <div class="series-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: {{.Progress}}%"></div>
                        </div>
                        <span class="progress-stats">{{.EpisodesWatched}}/{{.TotalEpisodes}} Episoden</span>
                    </div>
                </div>

                <div class="card-actions">
                    <form action="/update" method="post" class="update-form">
                        <input type="hidden" name="id" value="{{.ID}}">
                        <div class="episode-controls">
                            <label>Episoden:</label>
                            <input type="number" name="episodes" value="{{.EpisodesWatched}}"
                                   min="0" max="{{.TotalEpisodes}}" class="episode-input">
                            <button type="submit" class="netflix-btn secondary small">
                                ‚úì
                            </button>
                        </div>
                    </form>
                    <a href="https://www.imdb.com/title/{{.IMDBID}}" target="_blank" class="imdb-link">
                        IMDb
                    </a>
                </div>

                <div class="card-status">
                    <span class="status-badge {{.Status}}">{{.Status}}</span>
                </div>
            </div>
            {{end}}
        </div>
        {{else}}
        <div class="empty-library">
            <div class="empty-icon">üì∫</div>
            <h3>Deine Liste ist leer</h3>
            <p>F√ºge Serien √ºber die Startseite hinzu.</p>
        </div>
        {{end}}
    </section>

    <footer class="netflix-footer">
        <div class="footer-bottom">
            <p>&copy; 2025 Serien Tracker</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const cards = document.querySelectorAll('.series-card');
            cards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'scale(1.05)';
                    this.style.zIndex = '10';
                });
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'scale(1)';
                    this.style.zIndex = '1';
                });
            });

            const progressCircles = document.querySelectorAll('.progress-circle .progress-fill');
            progressCircles.forEach(circle => {
                const card = circle.closest('.series-card');
                if (card) {
                    const progress = parseInt(card.getAttribute('data-progress')) || 0;
                    const circumference = 2 * Math.PI * 18;
                    const offset = circumference - (progress / 100) * circumference;
                    if (typeof circle.setAttribute === 'function') {
                        circle.setAttribute('stroke-dasharray', circumference);
                        circle.setAttribute('stroke-dashoffset', offset);
                    } else {
                        circle.style.strokeDasharray = circumference;
                        circle.style.strokeDashoffset = offset;
                    }
                }
            });
        });
    </script>
</body>
</html>